version: '3.1'

services:
  nginx:
    image: nginx
    restart: always
    volumes:
      - /srv/ingress:/etc/nginx/conf.d/
      - /root/.acme.sh/*.zxyxyhome.duckdns.org_ecc/:/etc/ssl/certs/nginx/
      - /srv/proxysetting:/srv/proxysetting
    ports:
      - 80:80
      - 443:443

  duckdns:
    image: linuxserver/duckdns:version-b9e2cafd
    container_name: duckdns
    network_mode: host
    environment:
      - SUBDOMAINS=zxyxy
      - TOKEN=bd57877e-769e-44f7-ac6e-8b21916d9308
    restart: unless-stopped

  plex:
    image: lscr.io/linuxserver/plex:1.41.2
    container_name: plex
    network_mode: host
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Etc/UTC
      - VERSION=docker
    volumes:
      - /storage01/flexconfig:/config
      - /storage01/share/Video/:/Video
      - /storage01/share/Audio/:/Audio
    restart: unless-stopped

    #  openproject:
    #    image: openproject/openproject:14.5.1
    #    ports:
    #      - 8085:80
    #    volumes:
    #      - /storage02/openproject/pgdate:/var/openproject/pgdata
    #      - /storage02/openproject/assets:/var/openproject/assets
    #    environment:
    #      - OPENPROJECT_HOST__NAME=openproject.zxyxyhome.duckdns.org
    #      - OPENPROJECT_SECRET_KEY_BASE=Estimator2-Seclusion2-Pessimism6-Sixtyfold6-Riverboat4
    #      - OPENPROJECT_HTTPS=true
    #      - OPENPROJECT_DEFAULT__LANGUAGE=en

  runnerzxapi:
    image: gitlab/gitlab-runner:ubuntu-bleeding
    container_name: zxapi
    volumes:
      - /srv/gitlab-runner/config:/srv/gitlab-runner/config
      - /var/run/docker.sock:/var/run/docker.sock

  runnerzxfront:
    image: gitlab/gitlab-runner:ubuntu-bleeding
    container_name: zxfront
    volumes:
      - /srv/gitlab-runner/config:/srv/gitlab-runner/config
      - /var/run/docker.sock:/var/run/docker.sock

  runnerzxtest:
    image: gitlab/gitlab-runner:ubuntu-bleeding
    container_name: zxtest
    volumes:
      - /srv/gitlab-runner/config:/srv/gitlab-runner/config
      - /var/run/docker.sock:/var/run/docker.sock


